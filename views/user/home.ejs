<%-include("../../views/partials/user/header")%>
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  </head>
  
	<body>
		
	
		<aside id="colorlib-hero">
			<div class="flexslider">
				<ul class="slides">
			   	<li style="background-image: url(images/sneaker_main.jpg);">
			   		<div class="overlay"></div>
			   		<div class="container-fluid">
			   			<div class="row">
				   			<div class="col-sm-6 offset-sm-3 text-center slider-text">
				   				<div class="slider-text-inner">
				   					<div class="desc" >
					   					<h1 class="head-1">Men's</h1>
					   					<h2 class="head-2">Shoes</h2>
					   					<h2 class="head-3">Collection</h2>
					   					<p class="category"><span>New trending shoes</span></p>
					   					<p><a href="#" class="btn btn-primary">Shop Collection</a></p>
				   					</div>
				   				</div>
				   			</div>
				   		</div>
			   		</div>
			   	</li>
			   	<li style="background-image: url(images/sneaker_main2.jpg);">
			   		<div class="overlay"></div>
			   		<div class="container-fluid">
			   			<div class="row">
				   			<div class="col-sm-6 offset-sm-3 text-center slider-text">
				   				<div class="slider-text-inner">
				   					<div class="desc">
					   					<h1 class="head-1">Huge</h1>
					   					<h2 class="head-2">Sale</h2>
					   					<h2 class="head-3"><strong class="font-weight-bold">50%</strong> Off</h2>
					   					<p class="category"><span>Big sale sandals</span></p>
					   					<p><a href="#" class="btn btn-primary">Shop Collection</a></p>
				   					</div>
				   				</div>
				   			</div>
				   		</div>
			   		</div>
			   	</li>
			   	<li style="background-image: url(images/sneaker_main3.jpg);">
			   		<div class="overlay"></div>
			   		<div class="container-fluid">
			   			<div class="row">
				   			<div class="col-sm-6 offset-sm-3 text-center slider-text">
				   				<div class="slider-text-inner">
				   					<div class="desc">
					   					<h1 class="head-1">New</h1>
					   					<h2 class="head-2">Arrival</h2>
					   					<h2 class="head-3">up to <strong class="font-weight-bold">30%</strong> off</h2>
					   					<p class="category"><span>New stylish shoes for men</span></p>
					   					<p><a href="#" class="btn btn-primary">Shop Collection</a></p>
				   					</div>
				   				</div>
				   			</div>
				   		</div>
			   		</div>
			   	</li>
			  	</ul>
		  	</div>
		</aside>
		<div class="colorlib-intro">
			<div class="container">
				<div class="row">
					<div class="col-sm-12 text-center">
						<h2 class="intro">It started with a simple idea: Create quality, well-designed products that I wanted myself.</h2>
					</div>
				</div>
			</div>
		</div>
		<div class="colorlib-product">
			<div class="container-fluid">
				<div class="row">
					<div class="col-sm-6 text-center">
						<div class="featured">
							<a href="#" class="featured-img" style="background-image: url(images/men.jpg);"></a>
							<div class="desc">
								<h2><a href="#">Shop Men's Collection</a></h2>
							</div>
						</div>
					</div>
					<div class="col-sm-6 text-center">
						<div class="featured">
							<a href="#" class="featured-img" style="background-image: url(images/women.jpg);"></a>
							<div class="desc">
								<h2><a href="#">Shop Women's Collection</a></h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-product">
			<div class="container">
				<div class="row">

					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading">
						<h2>Best Sellers</h2>
					</div>
				</div>



				<div class="category-dropdown" style="position: relative;">
					<span style="font-weight: 700;">CATEGORIES</span> <i class="fa fa-chevron-down"></i>
					<ul class="hidden" style="list-style: none; background-color: #fff; box-shadow: 0px 4px 8px rgba(0,0,0,0.1); padding: 10px; display: none;">
						<li><a href="/?category=all">All Categories</a></li> <!-- Option for All Categories -->
						<% if (categories && categories.length > 0) { %>
							<% for (let i = 0; i < categories.length; i++) { %>
								<li><a href="/?category=<%= categories[i].name %>"><%= categories[i].name %> </a></li>
							<% } %>
						<% } else { %>
							<li>No categories available</li>
						<% } %>
					</ul>
				</div>
				
				
				<div class="sort-options">
					<label for="sort">Sort by:</label>
					<select id="sort" name="sort" onchange="applySorting()">
						<option value="popularity">Popularity</option>
						<option value="priceLowHigh">Price: Low to High</option>
						<option value="priceHighLow">Price: High to Low</option>
						<option value="averageRatings">Average Ratings</option>
						<option value="featured">Featured</option>
						<option value="newArrivals">New Arrivals</option>
						<option value="az">A - Z</option>
						<option value="za">Z - A</option>
					</select>
				</div>


					<div class="row row-pb-md">
						<% products.forEach((product, i) => { %>
						  <% if (product) { %>
							<div class="col-lg-3 mb-4 text-center">
							  <div class="product-entry border">
								<a href="/products/<%= product._id %>" class="prod-img">
								  <% if (product.productImage && product.productImage.length > 0) { %>
									<img src="/uploads/re-image/<%= product.productImage[0] %>" class="img-fluid" alt="<%= product.productName %>">
								  <% } else { %>
									<img src="/path/to/default/image.jpg" class="img-fluid" alt="No Image Available">
								  <% } %>
								</a>
								<div class="desc">
								  <h2><a href="/products/<%= product._id %>"><%= product.productName %></a></h2>
								  <span style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
								  <span class="price">
									₹<%= product.offerPrice > 0 ? Math.min(product.offerPrice, product.salePrice || Infinity) : product.salePrice %>
									
								  </span>
								  
								</div>
								<a href="javascript:void(0)" onclick="addToWishlist('<%= product._id %>')" >
								<i class="fa-regular fa-heart heart-icon" style="    display: inline-flex;"></i>
							</a>
							  </div>
							  
							</div>
						  <% } %>
						<% }); %>
					  </div>
					  
					  
					
				<div class="row">
					<div class="col-md-12 text-center">
						<p><a href="#" class="btn btn-primary btn-lg">Shop All Products</a></p>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-partner">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
						<h2>Trusted Partners</h2>
					</div>
				</div>
				<div class="row">
					<div class="col partner-col text-center">
						<img src="images/brand-1.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-2.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-3.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-4.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-5.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
				</div>
			</div>
		</div>

		<%-include("../../views/partials/user/footer")%>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<script>
			function applySorting() {
				const sortValue = document.getElementById('sort').value;
				window.location.href = `/?sort=${sortValue}`;
			}





		
  const categoryDropdown = document.querySelector('.category-dropdown');
  const categoryDropdownArrow = categoryDropdown.querySelector('.fa-chevron-down');
  const categoryDropdownList = categoryDropdown.querySelector('ul');

  // Toggle the dropdown list visibility
  categoryDropdown.addEventListener('click', (e) => {
    e.stopPropagation(); // Prevents the event from bubbling up to the body
    categoryDropdownList.classList.toggle('hidden');
    categoryDropdownList.style.display = categoryDropdownList.classList.contains('hidden') ? 'none' : 'block';
    categoryDropdownArrow.classList.toggle('fa-chevron-up');
  });

  // Close the dropdown if clicking outside of it
  document.addEventListener('click', () => {
    if (!categoryDropdownList.classList.contains('hidden')) {
      categoryDropdownList.classList.add('hidden');
      categoryDropdownList.style.display = 'none';
      categoryDropdownArrow.classList.remove('fa-chevron-up');
    }
  });






  async function addToWishlist(productId) {
    try {
        // Send a POST request to the server to add the item to the wishlist
        const response = await fetch('/wishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ productId }),
        });

        // Check if the request was successful
        if (response.ok) {
            const result = await response.json();
            
            // SweetAlert success notification
            Swal.fire({
                title: 'Added to Wishlist!',
                text: result.message || 'The product was added to your wishlist.',
                icon: 'success',
                confirmButtonText: 'Continue Shopping',
                timer: 3000,
                timerProgressBar: true,
            });
        } else {
            // SweetAlert error notification
            Swal.fire({
                title: 'Error',
                text: 'Error adding product to wishlist',
                icon: 'error',
                confirmButtonText: 'Try Again'
            });
        }
    } catch (error) {
        console.error('Error adding to wishlist:', error);
        // SweetAlert error notification for unexpected errors
        Swal.fire({
            title: 'Error',
            text: 'An error occurred. Please try again later.',
            icon: 'error',
            confirmButtonText: 'OK'
        });
    }
}




		</script>
		<style>
.heart-icon {
  position: absolute;
  bottom: 0; /* Positions the icon at the top */
  right: 0; /* Positions the icon at the right end */
  padding: 5px; /* Adjust padding for spacing */
  font-size: 20px; /* Adjust icon size */
  color: #525252; /* Set the icon color */
  cursor: pointer;
  margin-right: 1rem; /* Change cursor on hover to indicate it's clickable */
}



			.header__nav__option .sign-in-link {
		font-size: 16px;
		color: #333;
		margin-right: 15px;
		text-decoration: none;
		font-weight: 600;
	 }
	 .header__nav__option .sign-in-link:hover {
		color: #ff7f50;
	 }
	 
	 
	 .dropdown {
		position:relative;
		display:inline-block;
	 }
	 .dropdown-content {
		display: none;
		position:absolute;
		background-color: white;
		min-width: 160px;
		box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
		z-index:1000;
		right:0;
	 }
	 
	 
	 .dropdown-content a {
		color: black;
		padding: 12px 16px;
		text-decoration: none;
		display: block;
		width: 100%;
	 
	 
	 }
	 .dropdown-content a:hover{
		background-color: #f1f1f1;
	 }
	 .dropdown:hover .dropdown-content{
		display: block;
	 }
	 .header {
		position: relative;
		z-index: 500;
	 }
	 .category-dropdown {
    position: relative;
    z-index: 1001; /* Higher than sort options */
}

.category-dropdown ul {
    position: absolute;
    z-index: 1000; /* Ensure it pops up above other elements */
    display: none; /* Keep it hidden initially */
}

.sort-options {
    position: relative;
    z-index: 500; /* Lower z-index than category dropdown */
}

	 </style>
	 